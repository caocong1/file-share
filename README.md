# 局域网 P2P 文件传输系统

基于 WebRTC 的局域网内浏览器直传文件方案，无需服务器中转。

## 快速开始

1. 启动 HTTP 服务器：
```bash
python -m http.server 8000
```

2. 两台设备访问：
- 本机: `http://localhost:8000/file-share/`
- 其他设备: `http://[你的IP]:8000/file-share/`

3. 使用步骤：
- 点击"扫描局域网设备"自动发现
- 或点击"直接连接"手动输入对方 IP
- 选择目标设备
- 拖拽或选择文件开始传输

## 使用方法

### 方法一：自动扫描（推荐）
1. 点击"扫描局域网设备"
2. 系统会自动发现同网段的设备
3. 从列表中选择要传输的目标设备
4. 拖拽文件进行传输

### 方法二：直接连接（已知对方 IP）
1. 点击"手动设置 IP"，输入自己的局域网 IP
2. 点击"直接连接"按钮
3. 输入对方的 IP 地址（如：192.168.1.101）
4. 点击"连接"建立连接
5. 连接成功后即可传输文件

### 查看本机 IP
- Windows: 打开命令提示符，运行 `ipconfig`，查看"IPv4 地址"
- Mac: 打开终端，运行 `ifconfig | grep "inet "`
- Linux: 打开终端，运行 `ip addr` 或 `ifconfig`

## 常见问题

### Chrome 浏览器无法获取本机 IP

由于 Chrome 等现代浏览器的隐私保护机制（mDNS），可能无法自动获取本机局域网 IP。会显示类似 `c6b9a1fa-8487-474f-9d09-c0ad1eb99a09.local` 的随机域名。

**解决方法：**

1. **手动设置 IP**：点击"手动设置 IP"按钮，输入您的局域网 IP
2. **查看本机 IP**：
   - Windows: 打开命令提示符，运行 `ipconfig`
   - Mac/Linux: 打开终端，运行 `ifconfig` 或 `ip addr`
3. **直接扫描**：即使不知道本机 IP，也可以直接点击扫描，系统会尝试扫描常见网段

## 功能特点

- 自动扫描局域网设备
- P2P 直连，速度快
- 支持多文件传输
- 显示实时进度
- 自动接收下载

## 技术架构

- **WebRTC DataChannel**: P2P 数据传输
- **BroadcastChannel**: 本地信令交换
- **Service Worker**: 设备发现服务
- **局域网扫描**: 自动发现同网段设备

## 注意事项

- 需要现代浏览器支持
- 两设备必须在同一局域网
- 建议使用 Chrome/Edge/Firefox
- 如遇到连接问题，请检查防火墙设置 

## 数据完整性验证

系统支持可选的CRC32校验功能，用于检测传输过程中的数据损坏：

### 启用方法
在 `config.js` 中设置：
```javascript
config.options.enableHashVerification = true
```

### 特性
- ✅ **检测数据损坏**：每个数据块都有CRC32校验和
- ✅ **自动重传**：校验失败的块会被丢弃并可能触发重传
- ✅ **向后兼容**：未启用时使用标准格式

### 开销
- **计算开销**：每个chunk需要额外的CRC32计算时间
- **传输开销**：每个chunk增加4字节的校验和
- **内存开销**：略微增加CPU和内存使用

### 建议使用场景
- 🌐 **不稳定网络**：WiFi信号弱、移动网络等
- 📁 **重要文件**：需要确保完整性的关键数据
- 🔍 **调试模式**：排查传输问题时

### 性能影响
对于大文件传输，启用CRC32校验大约会：
- 增加 5-10% 的传输时间
- 增加 4字节/块 的网络开销 